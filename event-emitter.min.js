EventEmitter=function(){};var isArray=theosp.array.isArray,indexOf=theosp.array.indexOf;
EventEmitter.prototype.emit=function(a){if(a==="error")if(!this._events||!this._events.error||isArray(this._events.error)&&!this._events.error.length)if(arguments[1]instanceof Error)throw arguments[1];else throw Error("Uncaught, unspecified 'error' event.");if(!this._events)return false;var b=this._events[a];if(!b)return false;if(typeof b=="function"){if(arguments.length<=3)b.call(this,arguments[1],arguments[2]);else{var c=Array.prototype.slice.call(arguments,1);b.apply(this,c)}return true}else if(isArray(b)){c=
Array.prototype.slice.call(arguments,1);b=b.slice();for(var d=0,e=b.length;d<e;d++)b[d].apply(this,c);return true}else return false};EventEmitter.prototype.addListener=function(a,b){if("function"!==typeof b)throw Error("addListener only takes instances of Function");if(!this._events)this._events={};this.emit("newListener",a,b);if(this._events[a])if(isArray(this._events[a]))this._events[a].push(b);else this._events[a]=[this._events[a],b];else this._events[a]=b;return this};
EventEmitter.prototype.on=EventEmitter.prototype.addListener;EventEmitter.prototype.once=function(a,b){var c=this,d=function(){c.removeListener(a,d);b.apply(this,arguments)};c.on(a,d);return this};
EventEmitter.prototype.removeListener=function(a,b){if("function"!==typeof b)throw Error("removeListener only takes instances of Function");if(!this._events||!this._events[a])return this;var c=this._events[a];if(isArray(c)){var d=indexOf(b,c);if(d<0)return this;c.splice(d,1);c.length==0&&delete this._events[a]}else this._events[a]===b&&delete this._events[a];return this};EventEmitter.prototype.removeAllListeners=function(a){if(a&&this._events&&this._events[a])this._events[a]=null;return this};
EventEmitter.prototype.listeners=function(a){if(!this._events)this._events={};this._events[a]||(this._events[a]=[]);isArray(this._events[a])||(this._events[a]=[this._events[a]]);return this._events[a]};
